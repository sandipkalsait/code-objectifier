{
  "@AuthServiceApplication": {
    "@main": {
      "prefix": "@main",
      "body": [
        "SpringApplication.run(AuthServiceApplication.class, args);",
        "}"
      ],
      "description": "Extracted method: main"
    }
  },
  "@Device": {
    "@Device": {
      "prefix": "@Device",
      "body": [
        "this.id = id;",
        "this.name = name;",
        "this.type = type;",
        "this.manufacturer = manufacturer;",
        "this.isOnline = isOnline;",
        "}",
        "",
        "// Getters and setters",
        "public String getId() {",
        "return id;",
        "}",
        "",
        "public void setId(String id) {",
        "this.id = id;",
        "}",
        "",
        "public String getName() {",
        "return name;",
        "}",
        "",
        "public void setName(String name) {",
        "this.name = name;",
        "}",
        "",
        "public String getType() {",
        "return type;",
        "}",
        "",
        "public void setType(String type) {",
        "this.type = type;",
        "}",
        "",
        "public String getManufacturer() {",
        "return manufacturer;",
        "}",
        "",
        "public void setManufacturer(String manufacturer) {",
        "this.manufacturer = manufacturer;",
        "}",
        "",
        "public boolean isOnline() {",
        "return isOnline;",
        "}",
        "",
        "public void setOnline(boolean online) {",
        "isOnline = online;",
        "}",
        "",
        "// Overriding toString for better display",
        "@Override",
        "public String toString() {",
        "return \"Device{\" +",
        "\"id='\" + id + '\\'' +",
        "\", name='\" + name + '\\'' +",
        "\", type='\" + type + '\\'' +",
        "\", manufacturer='\" + manufacturer + '\\'' +",
        "\", isOnline=\" + isOnline +",
        "'}';",
        "}"
      ],
      "description": "Extracted method: Device"
    }
  },
  "@SecurityConfig": {
    "@authenticationProvider": {
      "prefix": "@authenticationProvider",
      "body": [
        "DaoAuthenticationProvider provider = new DaoAuthenticationProvider();",
        "provider.setUserDetailsService(customUserDetailsService); // Use custom user details service",
        "provider.setPasswordEncoder(passwordEncoder()); // Use BCrypt for password encoding",
        "return provider;",
        "}",
        "",
        "/**",
        "* Configures the password encoder for encrypting and validating user passwords.",
        "*/",
        "@Bean",
        "public PasswordEncoder passwordEncoder() {",
        "return new BCryptPasswordEncoder(); // Strong password encoding",
        "}",
        "",
        "@Bean",
        "public AuthenticationManager authenticationManager(AuthenticationConfiguration authConfig) throws Exception",
        "{",
        "",
        "return authConfig.getAuthenticationManager();",
        "",
        "}"
      ],
      "description": "Extracted method: authenticationProvider"
    }
  },
  "@AuthController": {
    "@registerUser": {
      "prefix": "@registerUser",
      "body": [
        "User user=new User(authRequest.getUsername(),authRequest.getPassword(),authRequest.getRole().orElse(\"USER\"));",
        "log.info(\"Received request to register user: {}\", user);",
        "try {",
        "log.info(\"Registering user: {}\", user);",
        "authService.registerUser(user);",
        "log.info(\"User successfully registered: {}\", user);",
        "return ResponseEntity.status(HttpStatus.CREATED).body(\"User registered successfully: \" + user);",
        "} catch (Exception e) {",
        "log.error(\"Error occurred during user registration: \", e);",
        "return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(\"Internal Server Error\");",
        "}",
        "}",
        "",
        "// Endpoint for user login",
        "@PostMapping(\"/login\")",
        "public ResponseEntity<String> loginUser(@RequestBody AuthRequest authRequest) {",
        "User user=new User(authRequest.getUsername(),authRequest.getPassword());",
        "log.info(\"Received login request for user: {}\", user);",
        "try {",
        "boolean isAuthenticated = authService.verifyUser(user);",
        "",
        "if (isAuthenticated) {",
        "log.info(\"User authenticated successfully: {}\", user.getUsername());",
        "String authToken = jwtService.generateToken(user.getUsername());",
        "log.info(\"Generated JWT token for user: {}\", user.getUsername());",
        "return ResponseEntity.status(HttpStatus.OK).body(\"User logged in successfully: \" + authToken);",
        "} else {",
        "log.warn(\"Invalid credentials for user: {}\", user.getUsername());",
        "return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(\"Invalid credentials\");",
        "}",
        "} catch (Exception e) {",
        "log.error(\"Error occurred during user login: \", e);",
        "return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(\"Internal Server Error\");",
        "}",
        "}"
      ],
      "description": "Extracted method: registerUser"
    }
  },
  "@GlobalExceptionHandler": {
    "@handleUsernameNotFoundException": {
      "prefix": "@handleUsernameNotFoundException",
      "body": [
        "log.trace(\"Entering handleUsernameNotFoundException method\");",
        "log.error(\"Username not found exception: {}\", ex.getMessage());",
        "log.trace(\"Exiting handleUsernameNotFoundException method\");",
        "return new ResponseEntity<>(ex.getMessage(), HttpStatus.NOT_FOUND); // Return 404 status",
        "}",
        "",
        "/**",
        "* Handles AccessDeniedException globally across all controllers.",
        "*",
        "* @param ex The exception to handle.",
        "* @return ResponseEntity with error message and status.",
        "*/",
        "@ExceptionHandler(AccessDeniedException.class)",
        "public ResponseEntity<Object> handleAccessDeniedException(AccessDeniedException ex) {",
        "log.trace(\"Entering handleAccessDeniedException method\");",
        "log.error(\"Access denied exception: {}\", ex.getMessage());",
        "log.trace(\"Exiting handleAccessDeniedException method\");",
        "return new ResponseEntity<>(\"Access Denied. You do not have permission.\", HttpStatus.FORBIDDEN); // Return 403 status",
        "}",
        "",
        "/**",
        "* Handles NullPointerException globally across all controllers.",
        "*",
        "* @param ex The exception to handle.",
        "* @return ResponseEntity with error message and status.",
        "*/",
        "@ExceptionHandler(NullPointerException.class)",
        "public ResponseEntity<Object> handleNullPointerException(NullPointerException ex) {",
        "log.trace(\"Entering handleNullPointerException method\");",
        "log.error(\"Null pointer exception: {}\", ex.getMessage(), ex);",
        "log.trace(\"Exiting handleNullPointerException method\");",
        "return new ResponseEntity<>(\"A null pointer error occurred. Please check the request.\", HttpStatus.BAD_REQUEST); // Return 400 status",
        "}",
        "",
        "/**",
        "* Handles IllegalArgumentException globally across all controllers.",
        "*",
        "* @param ex The exception to handle.",
        "* @return ResponseEntity with error message and status.",
        "*/",
        "@ExceptionHandler(IllegalArgumentException.class)",
        "public ResponseEntity<Object> handleIllegalArgumentException(IllegalArgumentException ex) {",
        "log.trace(\"Entering handleIllegalArgumentException method\");",
        "log.error(\"Illegal argument exception: {}\", ex.getMessage(), ex);",
        "log.trace(\"Exiting handleIllegalArgumentException method\");",
        "return new ResponseEntity<>(\"Invalid arguments provided. Please check the input.\", HttpStatus.BAD_REQUEST); // Return 400 status",
        "}",
        "",
        "/**",
        "* Handles any general exceptions globally across all controllers.",
        "*",
        "* @param ex The exception to handle.",
        "* @return ResponseEntity with error message and status.",
        "*/",
        "@ExceptionHandler(Exception.class)",
        "public ResponseEntity<Object> handleGenericException(Exception ex) {",
        "log.trace(\"Entering handleGenericException method\");",
        "log.error(\"An error occurred: {}\", ex.getMessage(), ex);",
        "log.trace(\"Exiting handleGenericException method\");",
        "return new ResponseEntity<>(\"An unexpected error occurred. Please try again later.\", HttpStatus.INTERNAL_SERVER_ERROR); // Return 500 status",
        "}"
      ],
      "description": "Extracted method: handleUsernameNotFoundException"
    }
  }
}